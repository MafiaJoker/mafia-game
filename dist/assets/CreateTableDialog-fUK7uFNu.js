import{a5 as k,r as m,D as V,a as C,c as I,b as D,w as o,d as n,m as R,E as S,e as U,H as F,I as N,j as E,i as h,J as q,l as G}from"./index-DopsCuGS.js";import{a as g}from"./el-radio-DW38t20Y.js";const M=k("events",()=>{const l=m([]),y=m(null),d=m(!1),p=V(()=>l.value.filter(a=>a.status!=="completed")),u=V(()=>l.value.filter(a=>a.status==="completed"));return{events:l,currentEvent:y,loading:d,activeEvents:p,archivedEvents:u,loadEvents:async()=>{d.value=!0;try{l.value=await g.getEvents()}catch(a){throw console.error("Ошибка загрузки мероприятий:",a),a}finally{d.value=!1}},getEventById:a=>l.value.find(e=>e.id===a),createEvent:async a=>{try{const e=await g.createEvent(a);return l.value.push(e),e}catch(e){throw console.error("Ошибка создания мероприятия:",e),e}},updateEvent:async(a,e)=>{try{const t=await g.updateEvent(a,e),i=l.value.findIndex(c=>c.id===a);return i!==-1&&(l.value[i]=t),t}catch(t){throw console.error("Ошибка обновления мероприятия:",t),t}},deleteEvent:async a=>{try{return await g.deleteEvent(a),l.value=l.value.filter(e=>e.id!==a),!0}catch(e){return console.error("Ошибка удаления мероприятия:",e),!1}}}}),z={__name:"CreateTableDialog",props:{modelValue:Boolean,eventId:Number},emits:["update:modelValue","table-created"],setup(l,{emit:y}){const d=l,p=y,u=m(),v=m(!1),r=C({name:"",judge:"",seatingType:"free",capacity:10}),b={name:[{required:!0,message:"Введите название стола",trigger:"blur"}]},f=V({get:()=>d.modelValue,set:e=>p("update:modelValue",e)}),_=()=>{var e;f.value=!1,(e=u.value)==null||e.resetFields()},a=async()=>{if(u.value)try{await u.value.validate(),v.value=!0;const e={...r};p("table-created",newTable),_()}catch(e){console.error("Ошибка создания стола:",e),G.error("Ошибка при создании стола")}finally{v.value=!1}};return(e,t)=>{const i=U,c=S,w=N,T=F,B=R,x=h,j=q;return D(),I(j,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=s=>f.value=s),title:"Новый стол",width:"500px","before-close":_},{footer:o(()=>[n(x,{onClick:_},{default:o(()=>t[6]||(t[6]=[E("Отмена")])),_:1,__:[6]}),n(x,{type:"primary",onClick:a,loading:v.value},{default:o(()=>t[7]||(t[7]=[E(" Создать стол ")])),_:1,__:[7]},8,["loading"])]),default:o(()=>[n(B,{model:r,rules:b,ref_key:"formRef",ref:u,"label-width":"120px"},{default:o(()=>[n(c,{label:"Название",prop:"name"},{default:o(()=>[n(i,{modelValue:r.name,"onUpdate:modelValue":t[0]||(t[0]=s=>r.name=s),placeholder:"Например: Стол 1"},null,8,["modelValue"])]),_:1}),n(c,{label:"Судья",prop:"judge"},{default:o(()=>[n(i,{modelValue:r.judge,"onUpdate:modelValue":t[1]||(t[1]=s=>r.judge=s),placeholder:"Имя судьи"},null,8,["modelValue"])]),_:1}),n(c,{label:"Тип рассадки",prop:"seatingType"},{default:o(()=>[n(T,{modelValue:r.seatingType,"onUpdate:modelValue":t[2]||(t[2]=s=>r.seatingType=s)},{default:o(()=>[n(w,{value:"free"},{default:o(()=>t[4]||(t[4]=[E("Свободная рассадка")])),_:1,__:[4]}),n(w,{value:"fixed"},{default:o(()=>t[5]||(t[5]=[E("Заданная рассадка")])),_:1,__:[5]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};export{z as _,M as u};
